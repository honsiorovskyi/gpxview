"use strict";(self.webpackChunkgpx_viewer=self.webpackChunkgpx_viewer||[]).push([[716,883],{716:(t,e,a)=>{a.r(e),a.d(e,{Area:()=>r,Axis:()=>i,Bisect:()=>x,Chart:()=>y,CheckPoint:()=>p,Domain:()=>g,Grid:()=>l,LegendItem:()=>n,LegendSmall:()=>c,Path:()=>s,PositionMarker:()=>o,Range:()=>m,Ruler:()=>h,Scale:()=>u,Tooltip:()=>d});const r=({width:t,height:e,xAttr:a,yAttr:r,scaleX:s,scaleY:i,interpolation:l="curveLinear"})=>d3.area().curve("string"==typeof l?d3[l]:l).x((t=>t.xDiagCoord=s(t[a]))).y0(e).y1((t=>i(t[r]))),s=({name:t,color:e,strokeColor:a,strokeOpacity:r,fillOpacity:s,className:i=""})=>{let l=d3.create("svg:path");return t&&l.classed(t+" "+i,!0),l.style("pointer-events","none"),l.attr("fill",e||"#3366CC").attr("stroke",a||"#000").attr("stroke-opacity",r||"1").attr("fill-opacity",s||"0.8"),l},i=({type:t="axis",tickSize:e=6,tickPadding:a=3,position:r,height:s,width:i,axis:l,scale:o,ticks:n,tickFormat:c,label:d,labelX:h,labelY:p,name:g="",onAxisMount:m})=>u=>{let[x,y]=[0,0];"bottom"==r&&(y=s),"right"==r&&(x=i),"x"==l&&"grid"==t?e=-s:"y"==l&&"grid"==t&&(e=-i);let f=d3["axis"+r.replace(/\b\w/g,(t=>t.toUpperCase()))]().scale(o).ticks("function"==typeof n?n():n).tickPadding(a).tickSize(e).tickFormat(c),v=u.append("g").attr("class",[l,t,r,g].join(" ")).attr("transform","translate("+x+","+y+")").call(f);return d&&v.append("svg:text").attr("x",h).attr("y",p).text(d),m&&v.call(m),v},l=t=>(t.type="grid",i(t)),o=({theme:t,xCoord:e=0,yCoord:a=0,labels:r={},item:s={},length:i=0})=>l=>{l.attr("class","height-focus-group");let o,n=l.select(".height-focus.line"),c=l.select(".height-focus.circle-lower"),d=l.select(".height-focus-label");return n.node()||(n=l.append("svg:line")),c.node()||(c=l.append("svg:circle")),d.node()||(d=l.append("svg:text")),isNaN(e)||isNaN(a)||(c.attr("class",t+" height-focus circle-lower").attr("transform","translate("+e+","+a+")").attr("r",6).attr("cx",0).attr("cy",0),n.attr("class",t+" height-focus line").attr("x1",e).attr("x2",e).attr("y1",a).attr("y2",i),d.attr("class",t+" height-focus-label").style("pointer-events","none").attr("x",e+5).attr("y",i),Object.keys(r).sort(((t,e)=>r[t].order-r[e].order)).forEach((t=>{o=d.select(".height-focus-"+r[t].name),o.size()||(o=d.append("svg:tspan").attr("class","height-focus-"+r[t].name).attr("dy","1.5em")),o.text("function"!=typeof r[t].value?r[t].value:r[t].value(s))})),d.select("tspan").attr("dy",d.selectAll("tspan").size()>1?"-1.5em":"0em"),d.selectAll("tspan").attr("x",e+5)),l},n=({name:t,label:e,width:a,height:r,margins:s={},color:i,path:l,className:o=""})=>n=>(n.attr("class","legend-item legend-"+t.toLowerCase()).attr("data-name",t),n.on("click.legend",(()=>d3.select(n.node().ownerSVGElement||n).dispatch("legend_clicked",{detail:{path:l.node(),name:t,legend:n.node(),enabled:!l.classed("leaflet-hidden")}}))),n.append("svg:rect").attr("x",a/2-50).attr("y",r+s.bottom/2).attr("width",50).attr("height",10).attr("fill",i).attr("stroke","#000").attr("stroke-opacity","0.5").attr("fill-opacity","0.25").attr("class",o),n.append("svg:text").text(L._(e||t)).attr("x",a/2+5).attr("font-size",10).style("font-weight","700").attr("y",r+s.bottom/2).attr("dy","0.75em"),n),c=({width:t,height:e,items:a,onClick:r})=>s=>{let i=0;s.data([{x:t,y:e+40}]).attr("transform",(t=>"translate("+t.x+","+t.y+")")).classed("legend-switcher");let l=s.append("svg:text").attr("class","legend-switcher-label").attr("text-anchor","end").attr("x",-25).attr("y",5).on("mousedown",((t,e)=>n(L.Util.wrapNum(i+1,[0,a.length])))),o=s.selectAll(".legend-switcher-symbol").data([{type:d3.symbolTriangle,x:0,y:3,angle:0,size:50,id:"down"},{type:d3.symbolTriangle,x:-13,y:0,angle:180,size:50,id:"up"}]);o.exit().remove(),l.exit().remove(),o.enter().append("svg:path").attr("class","legend-switcher-symbol").attr("cursor","pointer").attr("fill","#000").merge(o).attr("d",d3.symbol().type((t=>t.type)).size((t=>t.size))).attr("transform",(t=>"translate("+t.x+","+t.y+") rotate("+t.angle+")")).on("mousedown",((t,e)=>n(L.Util.wrapNum("up"===e.id?i+1:i-1,[0,a.length]))));const n=t=>{i=t,l.text(a.length?L._(a[i][0].toUpperCase()+a[i].slice(1)):""),r(a[i])};return n(0),s},d=({xCoord:t,yCoord:e,width:a,height:r,labels:s={},item:i={}})=>l=>{let o=l.select(".mouse-focus-line"),n=l.select(".mouse-focus-label");o.node()||(o=l.append("svg:line")),n.node()||(n=l.append("g"));let c=n.select(".mouse-focus-label-rect"),d=n.select(".mouse-focus-label-text");c.node()||(c=n.append("svg:rect")),d.node()||(d=n.append("svg:text"));let h,p=0,g=0,m={width:0,height:0};try{m=d.node().getBBox()}catch(t){return l}return t&&(p=t+(t<a/2?10:-m.width-10)),e&&(g=Math.max(e-m.height,L.Browser.webkit?0:-1/0)),o.attr("class","mouse-focus-line").attr("x2",t).attr("y2",0).attr("x1",t).attr("y1",r),n.attr("class","mouse-focus-label"),c.attr("class","mouse-focus-label-rect").attr("x",p-5).attr("y",g-5).attr("width",m.width+10).attr("height",m.height+10).attr("rx",3).attr("ry",3),d.attr("class","mouse-focus-label-text").style("font-weight","700").attr("y",g),Object.keys(s).sort(((t,e)=>s[t].order-s[e].order)).forEach((t=>{h=d.select(".mouse-focus-label-"+s[t].name),h.size()||(h=d.append("svg:tspan",".mouse-focus-label-x").attr("class","mouse-focus-label-"+s[t].name).attr("dy","1.5em")),h.text("function"!=typeof s[t].value?s[t].value:s[t].value(i))})),d.select("tspan").attr("dy","1em"),d.selectAll("tspan").attr("x",p),l},h=({height:t,width:e})=>a=>{a.data([{x:0,y:t}]).attr("transform",(t=>"translate("+t.x+","+t.y+")"));let r=a.selectAll(".horizontal-drag-rect").data([{w:e}]),s=a.selectAll(".horizontal-drag-line").data([{w:e}]),i=a.selectAll(".horizontal-drag-label").data([{w:e-8}]),l=a.selectAll(".horizontal-drag-symbol").data([{type:d3.symbolTriangle,x:e+7,y:0,angle:-90,size:50}]);return r.exit().remove(),s.exit().remove(),i.exit().remove(),l.exit().remove(),r.enter().append("svg:rect").attr("class","horizontal-drag-rect").attr("x",0).attr("y",-8).attr("height",8).attr("fill","none").attr("pointer-events","all").merge(r).attr("width",(t=>t.w)),s.enter().append("svg:line").attr("class","horizontal-drag-line").attr("x1",0).merge(s).attr("x2",(t=>t.w)),i.enter().append("svg:text").attr("class","horizontal-drag-label").attr("text-anchor","end").attr("y",-8).merge(i).attr("x",(t=>t.w)),l.enter().append("svg:path").attr("class","horizontal-drag-symbol").merge(l).attr("d",d3.symbol().type((t=>t.type)).size((t=>t.size))).attr("transform",(t=>"translate("+t.x+","+t.y+") rotate("+t.angle+")")),a},p=({point:t,height:e,width:a,x:r,y:s})=>i=>(isNaN(r)||isNaN(s)||(t.item&&t.item.property("isConnected")||(t.position=t.position||"bottom",t.item=i.append("g"),t.item.append("svg:line").attr("y1",0).attr("x1",0).attr("style","stroke: rgb(51, 51, 51); stroke-width: 0.5; stroke-dasharray: 2, 2;"),t.item.append("svg:circle").attr("class"," height-focus circle-lower").attr("r",3),t.label&&t.item.append("svg:text").attr("dx","4px").attr("dy","-4px")),t.item.datum({pos:t.position,x:r,y:s}).attr("class",(t=>"point "+t.pos)).attr("transform",(t=>"translate("+t.x+","+t.y+")")),t.item.select("line").datum({y2:{top:-s,bottom:e-s}[t.position],x2:{left:-r,right:a-r}[t.position]||0}).attr("y2",(t=>t.y2)).attr("x2",(t=>t.x2)),t.label&&t.item.select("text").text(t.label)),i),g=({min:t,max:e,attr:a,name:r,forceBounds:s,scale:i})=>function(l){a=i&&i.attr||a||r;let o=l&&l.length?d3.extent(l,(t=>t[a])):[0,1];return void 0!==t&&(t<o[0]||s)&&(o[0]=t),void 0!==e&&(e>o[1]||s)&&(o[1]=e),o},m=({axis:t})=>function(e,a){return"x"==t?[0,e]:"y"==t?[a,0]:void 0},u=({data:t,attr:e,min:a,max:r,forceBounds:s,range:i})=>d3.scaleLinear().range(i).domain(g({min:a,max:r,attr:e,forceBounds:s})(t)),x=({data:t=[0,1],scale:e,x:a,attr:r})=>d3.bisector((t=>t[r])).left(t,e.invert(a)),y=({width:t,height:e,margins:a={},ruler:r})=>{const s=t-a.left-a.right,i=e-a.top-a.bottom,l=d3.create("svg:svg").attr("class","background"),o=l.append("svg:defs"),n=l.append("g"),c={grid:n.append("g").attr("class","grid"),area:n.append("g").attr("class","area"),axis:n.append("g").attr("class","axis"),point:n.append("g").attr("class","point"),brush:n.append("g").attr("class","brush"),tooltip:n.append("g").attr("class","tooltip").attr("display","none"),ruler:n.append("g").attr("class","ruler"),legend:n.append("g").attr("class","legend")},p=c.area.append("svg:mask").attr("id","elevation-clipper-"+Math.random().toString(36).substr(2,9)).attr("fill-opacity",1),g=p.append("svg:rect").attr("class","zoom").attr("fill","white"),m=c.area.append("svg:foreignObject").attr("mask","url(#"+p.attr("id")+")"),x=m.append("xhtml:canvas").attr("class","canvas-plot"),y=x.node().getContext("2d");c.tooltip.call(d({xCoord:0,yCoord:0,height:i,width:s,labels:{}}));let f=d3.brushX().on("start.cursor end.cursor brush.cursor",(()=>c.brush.select(".overlay").attr("cursor",null))),v={defs:o,mask:p,canvas:x,context:y,brush:f},b={svg:l,g:n,panes:c,utils:v,scale:t=>({x:u(t.x),y:u(t.y)}),_resize:({width:t,height:e,margins:a={},ruler:r})=>{const s=t-a.left-a.right,i=e-a.top-a.bottom;l.attr("width",t).attr("height",e).attr("viewBox",`0 0 ${t} ${e}`),n.attr("transform","translate("+a.left+","+a.top+")"),/Mac|iPod|iPhone|iPad/.test(navigator.platform)&&/AppleWebkit/i.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&x.style("transform","translate("+a.left+"px,"+a.top+"px)"),g.attr("width",s).attr("height",i).attr("x",0).attr("y",0),m.attr("width",s).attr("height",i),x.attr("width",s).attr("height",i),r&&c.ruler.call(h({height:i,width:s})),c.brush.call(f.extent([[0,0],[s,i]])),c.brush.select(".overlay").attr("cursor",null),b._width=s,b._height=i,b.svg.dispatch("resize",{detail:{width:s,height:i}})},pane:t=>c[t]||(c[t]=n.append("g").attr("class",t)),get:t=>v[t]};return b._resize({width:t,height:e,margins:a}),b}},883:(t,e,a)=>{a.r(e),a.d(e,{Marker:()=>i});var r=a(716);const s=L.Control.Elevation.Utils;var i=L.Class.extend({initialize(t,e){switch(this.options=t,this.control=e,this.options.marker){case"elevation-line":break;case"position-marker":this._marker=L.marker([0,0],{icon:this.options.markerIcon,zIndexOffset:1e6,interactive:!1})}return this._labels={},this},addTo(t){switch(this._map=t,this.options.marker){case"elevation-line":this._container=d3.select(t.getPane("elevationPane")).select("svg > g").call(r.PositionMarker({}));break;case"position-marker":this._marker.addTo(t,{pane:"overlayPane"})}return this},update(t){if(t?this._props=t:t=this._props,t)switch(t.options&&(this.options=t.options),this._map||this.addTo(t.map),this._latlng=t.item.latlng,this.options.marker){case"elevation-line":if(this._container){let e=this._map.latLngToLayerPoint(this._latlng);e=L.extend({},t.item,this._map._rotate?this._map.rotatedPointToMapPanePoint(e):e);let a=this.control._height()/t.yCoordMax*e[this.options.yAttr];isFinite(a)&&!isNaN(a)||(a=0),this._container.classed("leaflet-hidden",!1),this._container.call(r.PositionMarker({theme:this.options.theme,xCoord:e.x,yCoord:e.y,length:e.y-a,labels:this._labels,item:e}))}break;case"position-marker":s.removeClass(this._marker.getElement(),"leaflet-hidden"),this._marker.setLatLng(this._latlng)}},remove(){switch(this._props=null,this.options.marker){case"elevation-line":this._container&&this._container.classed("leaflet-hidden",!0);break;case"position-marker":s.addClass(this._marker.getElement(),"leaflet-hidden")}},getLatLng(){return this._latlng},_registerTooltip(t){this._labels[t.name]=t}})}}]);
//# sourceMappingURL=883.bundle.js.map