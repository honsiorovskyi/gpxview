"use strict";(self.webpackChunkgpx_viewer=self.webpackChunkgpx_viewer||[]).push([[716,861],{716:(t,e,s)=>{s.r(e),s.d(e,{Area:()=>a,Axis:()=>r,Bisect:()=>x,Chart:()=>u,CheckPoint:()=>p,Domain:()=>g,Grid:()=>n,LegendItem:()=>l,LegendSmall:()=>o,Path:()=>i,PositionMarker:()=>h,Range:()=>_,Ruler:()=>c,Scale:()=>m,Tooltip:()=>d});const a=({width:t,height:e,xAttr:s,yAttr:a,scaleX:i,scaleY:r,interpolation:n="curveLinear"})=>d3.area().curve("string"==typeof n?d3[n]:n).x((t=>t.xDiagCoord=i(t[s]))).y0(e).y1((t=>r(t[a]))),i=({name:t,color:e,strokeColor:s,strokeOpacity:a,fillOpacity:i,className:r=""})=>{let n=d3.create("svg:path");return t&&n.classed(t+" "+r,!0),n.style("pointer-events","none"),n.attr("fill",e||"#3366CC").attr("stroke",s||"#000").attr("stroke-opacity",a||"1").attr("fill-opacity",i||"0.8"),n},r=({type:t="axis",tickSize:e=6,tickPadding:s=3,position:a,height:i,width:r,axis:n,scale:h,ticks:l,tickFormat:o,label:d,labelX:c,labelY:p,name:g="",onAxisMount:_})=>m=>{let[x,u]=[0,0];"bottom"==a&&(u=i),"right"==a&&(x=r),"x"==n&&"grid"==t?e=-i:"y"==n&&"grid"==t&&(e=-r);let y=d3["axis"+a.replace(/\b\w/g,(t=>t.toUpperCase()))]().scale(h).ticks("function"==typeof l?l():l).tickPadding(s).tickSize(e).tickFormat(o),f=m.append("g").attr("class",[n,t,a,g].join(" ")).attr("transform","translate("+x+","+u+")").call(y);return d&&f.append("svg:text").attr("x",c).attr("y",p).text(d),_&&f.call(_),f},n=t=>(t.type="grid",r(t)),h=({theme:t,xCoord:e=0,yCoord:s=0,labels:a={},item:i={},length:r=0})=>n=>{n.attr("class","height-focus-group");let h,l=n.select(".height-focus.line"),o=n.select(".height-focus.circle-lower"),d=n.select(".height-focus-label");return l.node()||(l=n.append("svg:line")),o.node()||(o=n.append("svg:circle")),d.node()||(d=n.append("svg:text")),isNaN(e)||isNaN(s)||(o.attr("class",t+" height-focus circle-lower").attr("transform","translate("+e+","+s+")").attr("r",6).attr("cx",0).attr("cy",0),l.attr("class",t+" height-focus line").attr("x1",e).attr("x2",e).attr("y1",s).attr("y2",r),d.attr("class",t+" height-focus-label").style("pointer-events","none").attr("x",e+5).attr("y",r),Object.keys(a).sort(((t,e)=>a[t].order-a[e].order)).forEach((t=>{h=d.select(".height-focus-"+a[t].name),h.size()||(h=d.append("svg:tspan").attr("class","height-focus-"+a[t].name).attr("dy","1.5em")),h.text("function"!=typeof a[t].value?a[t].value:a[t].value(i))})),d.select("tspan").attr("dy",d.selectAll("tspan").size()>1?"-1.5em":"0em"),d.selectAll("tspan").attr("x",e+5)),n},l=({name:t,label:e,width:s,height:a,margins:i={},color:r,path:n,className:h=""})=>l=>(l.attr("class","legend-item legend-"+t.toLowerCase()).attr("data-name",t),l.on("click.legend",(()=>d3.select(l.node().ownerSVGElement||l).dispatch("legend_clicked",{detail:{path:n.node(),name:t,legend:l.node(),enabled:!n.classed("leaflet-hidden")}}))),l.append("svg:rect").attr("x",s/2-50).attr("y",a+i.bottom/2).attr("width",50).attr("height",10).attr("fill",r).attr("stroke","#000").attr("stroke-opacity","0.5").attr("fill-opacity","0.25").attr("class",h),l.append("svg:text").text(L._(e||t)).attr("x",s/2+5).attr("font-size",10).style("font-weight","700").attr("y",a+i.bottom/2).attr("dy","0.75em"),l),o=({width:t,height:e,items:s,onClick:a})=>i=>{let r=0;i.data([{x:t,y:e+40}]).attr("transform",(t=>"translate("+t.x+","+t.y+")")).classed("legend-switcher");let n=i.append("svg:text").attr("class","legend-switcher-label").attr("text-anchor","end").attr("x",-25).attr("y",5).on("mousedown",((t,e)=>l(L.Util.wrapNum(r+1,[0,s.length])))),h=i.selectAll(".legend-switcher-symbol").data([{type:d3.symbolTriangle,x:0,y:3,angle:0,size:50,id:"down"},{type:d3.symbolTriangle,x:-13,y:0,angle:180,size:50,id:"up"}]);h.exit().remove(),n.exit().remove(),h.enter().append("svg:path").attr("class","legend-switcher-symbol").attr("cursor","pointer").attr("fill","#000").merge(h).attr("d",d3.symbol().type((t=>t.type)).size((t=>t.size))).attr("transform",(t=>"translate("+t.x+","+t.y+") rotate("+t.angle+")")).on("mousedown",((t,e)=>l(L.Util.wrapNum("up"===e.id?r+1:r-1,[0,s.length]))));const l=t=>{r=t,n.text(s.length?L._(s[r][0].toUpperCase()+s[r].slice(1)):""),a(s[r])};return l(0),i},d=({xCoord:t,yCoord:e,width:s,height:a,labels:i={},item:r={}})=>n=>{let h=n.select(".mouse-focus-line"),l=n.select(".mouse-focus-label");h.node()||(h=n.append("svg:line")),l.node()||(l=n.append("g"));let o=l.select(".mouse-focus-label-rect"),d=l.select(".mouse-focus-label-text");o.node()||(o=l.append("svg:rect")),d.node()||(d=l.append("svg:text"));let c,p=0,g=0,_={width:0,height:0};try{_=d.node().getBBox()}catch(t){return n}return t&&(p=t+(t<s/2?10:-_.width-10)),e&&(g=Math.max(e-_.height,L.Browser.webkit?0:-1/0)),h.attr("class","mouse-focus-line").attr("x2",t).attr("y2",0).attr("x1",t).attr("y1",a),l.attr("class","mouse-focus-label"),o.attr("class","mouse-focus-label-rect").attr("x",p-5).attr("y",g-5).attr("width",_.width+10).attr("height",_.height+10).attr("rx",3).attr("ry",3),d.attr("class","mouse-focus-label-text").style("font-weight","700").attr("y",g),Object.keys(i).sort(((t,e)=>i[t].order-i[e].order)).forEach((t=>{c=d.select(".mouse-focus-label-"+i[t].name),c.size()||(c=d.append("svg:tspan",".mouse-focus-label-x").attr("class","mouse-focus-label-"+i[t].name).attr("dy","1.5em")),c.text("function"!=typeof i[t].value?i[t].value:i[t].value(r))})),d.select("tspan").attr("dy","1em"),d.selectAll("tspan").attr("x",p),n},c=({height:t,width:e})=>s=>{s.data([{x:0,y:t}]).attr("transform",(t=>"translate("+t.x+","+t.y+")"));let a=s.selectAll(".horizontal-drag-rect").data([{w:e}]),i=s.selectAll(".horizontal-drag-line").data([{w:e}]),r=s.selectAll(".horizontal-drag-label").data([{w:e-8}]),n=s.selectAll(".horizontal-drag-symbol").data([{type:d3.symbolTriangle,x:e+7,y:0,angle:-90,size:50}]);return a.exit().remove(),i.exit().remove(),r.exit().remove(),n.exit().remove(),a.enter().append("svg:rect").attr("class","horizontal-drag-rect").attr("x",0).attr("y",-8).attr("height",8).attr("fill","none").attr("pointer-events","all").merge(a).attr("width",(t=>t.w)),i.enter().append("svg:line").attr("class","horizontal-drag-line").attr("x1",0).merge(i).attr("x2",(t=>t.w)),r.enter().append("svg:text").attr("class","horizontal-drag-label").attr("text-anchor","end").attr("y",-8).merge(r).attr("x",(t=>t.w)),n.enter().append("svg:path").attr("class","horizontal-drag-symbol").merge(n).attr("d",d3.symbol().type((t=>t.type)).size((t=>t.size))).attr("transform",(t=>"translate("+t.x+","+t.y+") rotate("+t.angle+")")),s},p=({point:t,height:e,width:s,x:a,y:i})=>r=>(isNaN(a)||isNaN(i)||(t.item&&t.item.property("isConnected")||(t.position=t.position||"bottom",t.item=r.append("g"),t.item.append("svg:line").attr("y1",0).attr("x1",0).attr("style","stroke: rgb(51, 51, 51); stroke-width: 0.5; stroke-dasharray: 2, 2;"),t.item.append("svg:circle").attr("class"," height-focus circle-lower").attr("r",3),t.label&&t.item.append("svg:text").attr("dx","4px").attr("dy","-4px")),t.item.datum({pos:t.position,x:a,y:i}).attr("class",(t=>"point "+t.pos)).attr("transform",(t=>"translate("+t.x+","+t.y+")")),t.item.select("line").datum({y2:{top:-i,bottom:e-i}[t.position],x2:{left:-a,right:s-a}[t.position]||0}).attr("y2",(t=>t.y2)).attr("x2",(t=>t.x2)),t.label&&t.item.select("text").text(t.label)),r),g=({min:t,max:e,attr:s,name:a,forceBounds:i,scale:r})=>function(n){s=r&&r.attr||s||a;let h=n&&n.length?d3.extent(n,(t=>t[s])):[0,1];return void 0!==t&&(t<h[0]||i)&&(h[0]=t),void 0!==e&&(e>h[1]||i)&&(h[1]=e),h},_=({axis:t})=>function(e,s){return"x"==t?[0,e]:"y"==t?[s,0]:void 0},m=({data:t,attr:e,min:s,max:a,forceBounds:i,range:r})=>d3.scaleLinear().range(r).domain(g({min:s,max:a,attr:e,forceBounds:i})(t)),x=({data:t=[0,1],scale:e,x:s,attr:a})=>d3.bisector((t=>t[a])).left(t,e.invert(s)),u=({width:t,height:e,margins:s={},ruler:a})=>{const i=t-s.left-s.right,r=e-s.top-s.bottom,n=d3.create("svg:svg").attr("class","background"),h=n.append("svg:defs"),l=n.append("g"),o={grid:l.append("g").attr("class","grid"),area:l.append("g").attr("class","area"),axis:l.append("g").attr("class","axis"),point:l.append("g").attr("class","point"),brush:l.append("g").attr("class","brush"),tooltip:l.append("g").attr("class","tooltip").attr("display","none"),ruler:l.append("g").attr("class","ruler"),legend:l.append("g").attr("class","legend")},p=o.area.append("svg:mask").attr("id","elevation-clipper-"+Math.random().toString(36).substr(2,9)).attr("fill-opacity",1),g=p.append("svg:rect").attr("class","zoom").attr("fill","white"),_=o.area.append("svg:foreignObject").attr("mask","url(#"+p.attr("id")+")"),x=_.append("xhtml:canvas").attr("class","canvas-plot"),u=x.node().getContext("2d");o.tooltip.call(d({xCoord:0,yCoord:0,height:r,width:i,labels:{}}));let y=d3.brushX().on("start.cursor end.cursor brush.cursor",(()=>o.brush.select(".overlay").attr("cursor",null))),f={defs:h,mask:p,canvas:x,context:u,brush:y},b={svg:n,g:l,panes:o,utils:f,scale:t=>({x:m(t.x),y:m(t.y)}),_resize:({width:t,height:e,margins:s={},ruler:a})=>{const i=t-s.left-s.right,r=e-s.top-s.bottom;n.attr("width",t).attr("height",e).attr("viewBox",`0 0 ${t} ${e}`),l.attr("transform","translate("+s.left+","+s.top+")"),/Mac|iPod|iPhone|iPad/.test(navigator.platform)&&/AppleWebkit/i.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&x.style("transform","translate("+s.left+"px,"+s.top+"px)"),g.attr("width",i).attr("height",r).attr("x",0).attr("y",0),_.attr("width",i).attr("height",r),x.attr("width",i).attr("height",r),a&&o.ruler.call(c({height:r,width:i})),o.brush.call(y.extent([[0,0],[i,r]])),o.brush.select(".overlay").attr("cursor",null),b._width=i,b._height=r,b.svg.dispatch("resize",{detail:{width:i,height:r}})},pane:t=>o[t]||(o[t]=l.append("g").attr("class",t)),get:t=>f[t]};return b._resize({width:t,height:e,margins:s}),b}},861:(t,e,s)=>{s.r(e),s.d(e,{Chart:()=>r});var a=s(716);const i=L.Control.Elevation.Utils;var r=L.Control.Elevation.Chart=L.Class.extend({includes:L.Evented?L.Evented.prototype:L.Mixin.Events,initialize(t,e){this.options=t,this.control=e,this._data=e._data||[],this._props={scales:{},paths:{},areas:{},grids:{},axes:{},legendItems:{},tooltipItems:{}},this._scales={},this._domains={},this._ranges={},this._paths={},this._brushEnabled=t.dragging,this._zoomEnabled=t.zooming,t.xTicks=this._xTicks(),t.yTicks=this._yTicks();let s=this._chart=a.Chart(t);this._container=s.svg,this._grid=s.pane("grid"),this._area=s.pane("area"),this._point=s.pane("point"),this._axis=s.pane("axis"),this._legend=s.pane("legend"),this._tooltip=s.pane("tooltip"),this._ruler=s.pane("ruler"),this._initScale(),this._mask=s.get("mask"),this._context=s.get("context"),this._brush=s.get("brush"),this._zoom=d3.zoom(),this._drag=d3.drag(),this._initInteractions(),this._maskGaps=[],e.on("eletrack_added",(({index:t})=>{this._maskGaps.push(t),e.once("elepoint_added",(({index:t})=>this._maskGaps.push(t)))}))},update(t){return t&&(t.data&&(this._data=t.data),t.options&&(this.options=t.options)),this.options.xTicks=this._xTicks(),this.options.yTicks=this._yTicks(),this._updateScale(),this._updateAxis(),this._updateMargins(),this._updateLegend(),this._updateClipper(),this._updateArea(),this},render(){return t=>t.append((()=>this._container.node()))},clear(){this._resetDrag(),this._hideDiagramIndicator(),this._area.selectAll("path").attr("d","M0 0"),this._context.clearRect(0,0,this._width(),this._height()),this._mask.selectAll(".gap").remove(),this._maskGaps=[]},_drawPath(t){let e=this._paths[t],s=this._props.areas[t];e.datum(this._data).attr("d",a.Area(L.extend({},s,{width:this._width(),height:this._height(),scaleX:this._scales[s.scaleX],scaleY:this._scales[s.scaleY]}))),e.classed("leaflet-hidden")||(this.options.preferCanvas?i.drawCanvas(this._context,e):i.append(this._area.node(),e.node()))},_hasActiveLayers(){const t=this._paths;for(var e in t)if(!t[e].classed("leaflet-hidden"))return!0;return!1},_initBrush(t){const e=t=>{if(this._data.length&&"brush"!=t.type){let e=this._chart.panes.brush.select(".overlay").node(),s=d3.pointers(t,e)[0][0],a=this._data[this._findIndexForXCoord(s)];this.fire("mouse_move",{item:a,xCoord:s})}};this._brush.filter((({shiftKey:t,button:e})=>!t&&!e&&this._brushEnabled)).on("end.update",(({selection:t})=>{if(t&&this._data.length){let e=this._findIndexForXCoord(t[0]),s=this._findIndexForXCoord(t[1]);this.fire("dragged",{dragstart:this._data[e],dragend:this._data[s]})}})).on("brush.update",e),this._chart.panes.brush.on("mouseenter.focus touchstart.focus",this.fire.bind(this,"mouse_enter")).on("mouseout.focus touchend.focus",this.fire.bind(this,"mouse_out")).on("mousemove.focus touchmove.focus",e)},_initClipper(){let t=this._container,e=this.options.margins;const s=this._zoom;s.scaleExtent([1,10]).extent([[e.left,0],[this._width()-e.right,this._height()]]).translateExtent([[e.left,-1/0],[this._width()-e.right,1/0]]).filter((({shiftKey:t,buttons:e})=>(t||4==e)&&this._zoomEnabled)).on("start",(({transform:e,sourceEvent:s})=>{s&&"mousedown"==s.type&&t.style("cursor","grabbing"),1==e.k&&0==e.x&&(this._container.classed("zoomed",!0),this._mask&&this._point.attr("mask","url(#"+this._mask.attr("id")+")")),this.zooming=!0})).on("end",(({transform:e})=>{1==e.k&&0==e.x&&(this._container.classed("zoomed",!1),this._mask&&this._point.attr("mask",null)),this.zooming=!1,t.style("cursor","")})).on("zoom",(({transform:t,sourceEvent:e})=>{this.zooming=!1,this._updateScale(),this.zooming=!0,this._scales.distance=this._x=t.rescaleX(this._x),this._scales.time&&(this._scales.time=t.rescaleX(this._scales.time)),this._resetDrag(),e&&"mousemove"==e.type&&this._hideDiagramIndicator(),this.fire("zoom")})),t.call(s)},_initInteractions(){this._initBrush(),this._initRuler(),this._initClipper(),this._initLegend()},_initLegend(){this._container.on("legend_clicked",(({detail:t})=>{let{path:e,legend:s,name:a,enabled:r}=t;if(e){let t=i.select("text",s),n=i.select("rect",s);i.toggleStyle(t,"text-decoration-line","line-through",r),i.toggleStyle(n,"fill-opacity","0",r),i.toggleClass(e,"leaflet-hidden",r),this._updateArea(),this.fire("elepath_toggle",{path:e,name:a,legend:s,enabled:r})}}))},_initRuler(){if(!this.options.ruler)return;const t=d3.format(".0f"),e=this._drag;e.on("start end",((t,e)=>{let s=this._height(),a=this._ruler.data()[0].y;(a>=s||a<=0)&&this._ruler.select(".horizontal-drag-label").text(""),this._hideDiagramIndicator()})).on("drag",((e,s)=>{let a=d3.pointers(e,this._area.node())[0][1],r=this._height(),n=i.clamp(a,[0,r]);this._ruler.data([L.extend(this._ruler.data()[0],{y:n})]).attr("transform",(t=>"translate("+t.x+","+t.y+")")).classed("active",n<r),this._container.select(".horizontal-drag-label").text(t(this._y.invert(n))+" "+(this.options.imperial?"ft":"m")),this.fire("ruler_filter",{coords:a<r&&a>0?this._findCoordsForY(a):[]})})),this._ruler.call(e)},_initScale(){let t=this.options;this._registerAxisScale({axis:"x",position:"bottom",attr:t.xAttr,min:t.xAxisMin,max:t.xAxisMax,name:"distance"}),this._registerAxisScale({axis:"y",position:"left",attr:t.yAttr,min:t.yAxisMin,max:t.yAxisMax,name:"altitude"}),this._x=this._scales.distance,this._y=this._scales.altitude},_registerAreaPath(t){"y"==t.scale?t.scale=this._y:"x"==t.scale&&(t.scale=this._x);let e=this.options;t.xAttr||(t.xAttr=e.xAttr),t.yAttr||(t.yAttr=e.yAttr),void 0===t.preferCanvas&&(t.preferCanvas=e.preferCanvas),this._paths[t.name]=a.Path(t),this._props.areas[t.name]=t,e.legend&&(this._props.legendItems[t.name]={name:t.name,label:t.label,color:t.color,className:t.className,path:this._paths[t.name]})},_registerAxisGrid(t){"y"==t.scale?t.scale=this._y:"x"==t.scale&&(t.scale=this._x),this._props.grids[t.name||t.axis]=t},_registerAxisScale(t){"y"==t.scale?t.scale=this._y:"x"==t.scale&&(t.scale=this._x);let e=this.options,s=t.scale;if("function"==typeof this._scales[t.name])t.scale=this._scales[t.name];else if("function"!=typeof s){s=L.extend({data:this._data,forceBounds:e.forceAxisBounds},s),s.attr=s.attr||t.name;let i=this._domains[t.name]=a.Domain(t),r=this._ranges[t.name]=a.Range(t);s.range=s.range||r(this._width(),this._height()),s.domain=s.domain||i(this._data),this._props.scales[t.name]=s,t.scale=this._scales[t.name]=a.Scale(s)}return t.ticks||("x"==t.axis?t.ticks=this._xTicks.bind(this):"y"==t.axis&&(t.ticks=this._yTicks.bind(this))),this._props.axes[t.name]=t,t.name==this.options.yScale&&(this._y=s),t.name==this.options.xScale&&(this._x=s),s},_registerCheckPoint(t){if(!this._data.length)return;const{xAttr:e,yAttr:s}=this.options;let i,r,n;t.latlng?(i=this._data[this._findIndexForLatLng(t.latlng)],r=this._x(i[e]),n=this._y(i[s])):isNaN(t[e])||(r=this._x(t[e]),i=this._data[this._findIndexForXCoord(r)],n=this._y(i[s])),this._point.call(a.CheckPoint({point:t,width:this._width(),height:this._height(),x:r,y:n}))},_registerTooltip(t){t.order=t.order??1e3,this._props.tooltipItems[t.name]=t},_updateArea(){this._context.clearRect(0,0,this._width(),this._height()),i.each(this._paths,((t,e)=>!t.classed("leaflet-hidden")&&this._drawPath(e)))},_updateAxis(){let t=this.options;const e={width:this._width(),height:this._height(),tickFormat:""},s={width:this._width(),height:this._height()};this._grid.selectAll("g").remove(),i.each(this._props.grids,((s,i)=>{!1!==t[i]&&"summary"!==t[i]&&this._grid.call(a.Grid(L.extend({},e,s)))})),this._axis.selectAll("g").remove(),i.each(this._props.axes,((e,i)=>{!1!==t[i]&&"summary"!==t[i]&&this._axis.call(a.Axis(L.extend({},s,e)))})),this._axis.selectAll(".y.axis.right").each(((t,e,s)=>{let a=d3.select(s[e]),i=a.attr("transform"),r=i.substring(i.indexOf("(")+1,i.indexOf(")")).split(",");a.attr("transform","translate("+(+r[0]+40*e)+","+r[1]+")"),e>0&&(a.select(":scope > path").attr("opacity",.25),a.selectAll(":scope > .tick line").attr("opacity",.75))}))},_updateClipper(){const{xAttr:t,margins:e}=this.options,s=this._data;this._zoom.scaleExtent([1,10]).extent([[e.left,0],[this._width()-e.right,this._height()]]).translateExtent([[e.left,-1/0],[this._width()-e.right,1/0]]),this._mask.selectAll(".gap").remove(),this._maskGaps.forEach(((e,a)=>{if(a>=this._maskGaps.length-2)return;let i=this._x(s[this._findIndexForLatLng(s[this._maskGaps[a]].latlng)][t]),r=this._x(s[this._findIndexForLatLng(s[this._maskGaps[a+1]].latlng)][t]);this._mask.append("rect").attr("x",i).attr("y",0).attr("width",r-i).attr("height",this._height()).attr("class","gap").attr("fill-opacity","0.8").attr("fill","black")}))},_updateLegend:function(){let t=this._axis.selectAll(".x.axis.bottom").nodes().length,e=Object.keys(this._paths),s=e.length,r=Array(Math.floor(s/2)).fill(null).map(((t,e)=>2*(e+1)-(1-Math.sign(s%2)))),n=r.slice().reverse().map((t=>-t));s%2!=0&&n.push(0),r=n.concat(r),this._legend.selectAll("g").remove(),i.each(this._props.legendItems,(t=>{this._legend.append("g").call(a.LegendItem(L.extend({width:this._width(),height:this._height(),margins:this.options.margins},t)))})),s>1&&this._legend.append("g").call(a.LegendSmall({width:this._width(),height:this._height(),items:e,onClick:t=>{i.each(e,(e=>this._togglePath(e,t==e,!0))),this._updateArea()}})),i.each(e,((e,s)=>{this._legend.select("[data-name="+e+"]").attr("transform","translate("+55*r[s]+", "+2*t+")"),this._togglePath(e,!(e in this.options&&"disabled"==this.options[e]),!0)}))},_updateMargins(){let t=this._axis.selectAll(".x.axis.bottom").nodes().length,e=this._axis.selectAll(".y.axis.left").nodes().length,s=this._axis.selectAll(".y.axis.right").nodes().length,a=60+2*t,i=10+30*e,r=40+30*s,n=!1;s&&this.options.margins.right<r&&(this.options.margins.right=r,n=!0),e&&this.options.margins.left<i&&(this.options.margins.left=i,n=!0),t&&this.options.margins.bottom<a&&(this.options.margins.bottom=a,n=!0),n&&this.fire("margins_updated")},_updateScale(){if(this.zooming)return{x:this._x,y:this._y};for(let t in this._scales)this._scales[t].domain(this._domains[t](this._data)).range(this._ranges[t](this._width(),this._height()));return{x:this._x,y:this._y}},_width(){this._chart&&this._chart._width;const{width:t,margins:e}=this.options;return t-e.left-e.right},_height(){if(this._chart)return this._chart._height;const{height:t,margins:e}=this.options;return t-e.top-e.bottom},_findCoordsForY(t){let e=this._data,s=this._y.invert(t);const a=e.reduce(((t,e,a)=>(e[this.options.yAttr]>=s&&t.push(a),t)),[]);let i,r=0;return a.reduce(((t,s,n)=>(i=n+1,a[i]===a[n]+1&&i!==a.length||(t.push(a.slice(r,i).map((t=>e[t].latlng))),r=i),t)),[])},_findIndexForXCoord(t){return d3.bisector((t=>t[this.options.xAttr])).left(this._data||[0,1],this._x.invert(t))},_findIndexForLatLng(t){let e=null,s=1/0;return this._data.forEach(((a,i)=>{let r=t.distanceTo(a.latlng);r<s&&(s=r,e=i)})),e},_resetDrag(){this._chart.panes.brush.select(".selection").attr("width")&&(this._chart.panes.brush.call(this._brush.clear),this._hideDiagramIndicator(),this.fire("reset_drag"))},_resetZoom(){this._zoom&&this._zoom.transform(this._chart.svg,d3.zoomIdentity)},_showDiagramIndicator(t,e){this._tooltip.attr("display",null).call(a.Tooltip({xCoord:e,yCoord:this._y(t[this.options.yAttr]),height:this._height(),width:this._width(),labels:this._props.tooltipItems,item:t}))},_togglePath(t,e=!0,s=!1){let a=this._paths[t],i=this._container.select(".legend [data-name="+t+"]");a.classed("leaflet-hidden",!e),i.select("text").style("text-decoration-line",e?"":"line-through"),i.select("rect").style("fill-opacity",e?"":"0"),this._mask&&a.attr("mask","url(#"+this._mask.attr("id")+")"),s||this._updateArea()},_hideDiagramIndicator(){this._tooltip.attr("display","none")},_xTicks(){return this.__xTicks&&(this.__xTicks=this.options.xTicks),this.__xTicks||Math.round(this._width()/75)},_yTicks(){return this.__yTicks&&(this.__yTicks=this.options.yTicks),this.__yTicks||Math.round(this._height()/30)}})}}]);
//# sourceMappingURL=861.bundle.js.map