"use strict";(self.webpackChunkgpx_viewer=self.webpackChunkgpx_viewer||[]).push([[27],{27:(t,i,e)=>{e.r(i),L.Control.EdgeScale=L.Control.extend({options:{position:"bottomleft",icon:!0,coords:!0,bar:!0,onMove:!0,template:"{y} | {x}",projected:!1,formatProjected:"#.##0,000",latlngFormat:"DD",latlngDesignators:!0,latLngFormatter:void 0,iconStyle:{background:"url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' viewBox='0 0 100 100'%3E%3Cg stroke='%23fff'%3E%3Ccircle cx='50' cy='50.2' r='3.9' stroke-width='2' /%3E%3Cpath stroke-width='3' d='M5 54h32a4 4 0 1 0 0-8H5a4 4 0 1 0 0 8z M54 5a4 4 0 1 0-8 0v32a4 4 0 1 0 8 0V5z M99 50c0-2-2-4-4-4H63a4 4 0 1 0 0 8h32c2 0 4-1 4-4zM46 95a4 4 0 1 0 8 0V64a4 4 0 1 0-8 0v31z'/%3E%3C/g%3E%3C/svg%3E%0A\")",width:"24px",height:"24px",left:"calc(50% - 12px)",top:"calc(50% - 12px)",content:"",display:"block",position:"absolute",zIndex:999,pointerEvents:"none"},containerStyle:{backgroundColor:"rgba(255, 255, 255, 0.7)",boxShadow:"0 0 5px #bbb",borderRadius:"3px",padding:"3px 2px",color:"#333",font:"11px/1.5 Consolas, monaco, monospace",writingMode:"vertical-lr"}},initialize:function(t){L.setOptions(this,t)},onAdd:function(t){return this.options.bar&&(this._scaleBar=new L.Control.EdgeScale.Layer(!0===this.options.bar?{}:this.options.bar).addTo(t)),this.options.icon&&(this._icon=L.DomUtil.create("div","leaflet-crosshair"),Object.assign(this._icon.style,this.options.iconStyle),t.getContainer().insertBefore(this._icon,t.getContainer().firstChild)),this._container=L.DomUtil.create("div","leaflet-control-mapcentercoord"),Object.assign(this._container.style,this.options.containerStyle),this.options.coords||(this._container.style.display="none"),L.DomEvent.disableClickPropagation(this._container),this._container.innerHTML=this._getMapCenterCoord(),t.on("move",this._onMapMove,this),t.on("moveend",this._onMapMove,this),this._container},onRemove:function(t){this.options.bar&&this._scaleBar.remove(),this.options.icon&&t.getContainer().removeChild(this._icon),t.off("move",this._onMapMove,this),t.off("moveend",this._onMapMove,this)},_onMapMove:function(t){(this.options.onMove||"moveend"===t.type)&&(this._container.innerHTML=this._getMapCenterCoord())},_getMapCenterCoord:function(){const t=this._map.getCenter();return this.options.projected?this._getProjectedCoord(this._map.options.crs.project(t)):this._getLatLngCoord(t)},_getProjectedCoord:function(t){return L.Util.template(this.options.template,{x:this._format(this.options.formatProjected,t.x),y:this._format(this.options.formatProjected,t.y)})},_getLatLngCoord:function(t){const{latLngFormatter:i,latlngFormat:e,latlngDesignators:n}=this.options;if(void 0!==i)return i(t.lat,t.lng);let o,s,a,r,h={lat:t.lat,lng:t.lng,lng_neg:t.lng<0,lat_neg:t.lat<0};return h.lng<0&&(h.lng=Math.abs(h.lng)),h.lng>180&&(h.lng=360-h.lng,h.lng_neg=!h.lng_neg),h.lat<0&&(h.lat=Math.abs(h.lat)),"DM"===e?(a=parseInt(h.lng),s=a+"º "+this._format("00.000",60*(h.lng-a))+"'",a=parseInt(h.lat),o=a+"º "+this._format("00.000",60*(h.lat-a))+"'"):"DMS"===e?(a=parseInt(h.lng),r=60*(h.lng-a),s=a+"º "+this._format("00",parseInt(r))+"' "+this._format("00.0",60*(r-parseInt(r)))+"''",a=parseInt(h.lat),r=60*(h.lat-a),o=a+"º "+this._format("00",parseInt(r))+"' "+this._format("00.0",60*(r-parseInt(r)))+"''"):(s=this._format("#0.00000",h.lng)+"º",o=this._format("##0.00000",h.lat)+"º"),L.Util.template(this.options.template,{x:(!n&&h.lng_neg?"-":"")+s+(n?h.lng_neg?" W":" E":""),y:(!n&&h.lat_neg?"-":"")+o+(n?h.lat_neg?" S":" N":"")})},_format:function(t,i){if(!t||isNaN(+i))return i;let e=(i="-"==t.charAt(0)?-i:+i)<0?i=-i:0,n=t.match(/[^\d\-\+#]/g),o=n&&n[n.length-1]||".",s=n&&n[1]&&n[0]||",";t=t.split(o),i=+(i=i.toFixed(t[1]&&t[1].length))+"";let a=t[1]&&t[1].lastIndexOf("0"),r=i.split(".");(!r[1]||r[1]&&r[1].length<=a)&&(i=(+i).toFixed(a+1));let h=t[0].split(s);t[0]=h.join("");let l=t[0]&&t[0].indexOf("0");if(l>-1)for(;r[0].length<t[0].length-l;)r[0]="0"+r[0];else 0==+r[0]&&(r[0]="");(i=i.split("."))[0]=r[0];var _=h[1]&&h[h.length-1].length;if(_){let t=i[0],e="",n=t.length%_;for(let i=0,o=t.length;i<o;i++)e+=t.charAt(i),!((i-n+1)%_)&&i<o-_&&(e+=s);i[0]=e}return i[1]=t[1]&&i[1]?o+i[1]:"",(e?"-":"")+i[0]+i[1]}}),L.Control.EdgeScale.Layer=L.Layer.extend({includes:L.Evented?L.Evented.prototype:L.Mixin.Events,options:{opacity:1,weight:.8,gradient:{size:10,opacity:.5},color:"#000",font:"11px Arial",zoomInterval:[{start:0,end:2,interval:5e6},{start:3,end:3,interval:2e6},{start:4,end:4,interval:1e6},{start:5,end:5,interval:5e5},{start:6,end:7,interval:2e5},{start:8,end:8,interval:1e5},{start:9,end:9,interval:5e4},{start:10,end:10,interval:2e4},{start:11,end:11,interval:1e4},{start:12,end:12,interval:5e3},{start:13,end:13,interval:2e3},{start:14,end:14,interval:1e3},{start:15,end:15,interval:500},{start:16,end:16,interval:200},{start:17,end:17,interval:100},{start:18,end:18,interval:50},{start:19,end:19,interval:20},{start:20,end:20,interval:10}],pane:"edgescalePane"},initialize:function(t){L.setOptions(this,t);const i=this._a=6378137,e=this._b=6356752.3142,n=this._n=(i-e)/(i+e),o=i*i,s=e*e,a=n*n,r=a*n,h=r*n,l=h*n;this._A=i*(1-n)*(1-a)*(1+9/4*a+225/64*h),this._e2=(o-s)/o,this._ic1=1.5*n-29/12*r+6.9125*l,this._ic2=21/8*a-1537/128*h,this._ic3=151/24*r-32373/640*l,this._ic4=1097/64*h,this._ic5=8011/150*l,this._c1=-1.5*n+31/24*r-669/640*l,this._c2=15/18*a-435/128*h,this._c3=-35/12*r+8.1375*l,this._c4=315/64*h,this._c5=-8.6625*l,this._LIMIT_PHI=1.484419982},onAdd:function(t){this._map=t;let i=t.getPane(this.options.pane);i||(i=this._pane=t.createPane("edgescalePane",t.getPane("norotatePane")||t.getPane("mapPane")),i.style.zIndex=625,i.style.pointerEvents="none"),this._pane=i,this._canvas||this._initCanvas(),this._pane.appendChild(this._canvas),t.on("viewreset",this._reset,this),t.on("move",this._reset,this),t.on("moveend",this._reset,this),t.on("rotate",this._reset,this),this._reset()},onRemove:function(t){this._pane.removeChild(this._canvas),t.off("viewreset",this._reset,this),t.off("move",this._reset,this),t.off("moveend",this._reset,this)},addTo:function(t){return t.addLayer(this),this},setOpacity:function(t){return this.options.opacity=t,L.DomUtil.setOpacity(this._canvas,this.options.opacity),this},bringToFront:function(){return this._canvas&&this._pane.appendChild(this._canvas),this},bringToBack:function(){return this._canvas&&this._pane.insertBefore(this._canvas,pane.firstChild),this},_initCanvas:function(){this._canvas=L.DomUtil.create("canvas",""),this._ctx=this._canvas.getContext("2d"),this.setOpacity(),L.extend(this._canvas,{onselectstart:L.Util.falseFn,onmousemove:L.Util.falseFn,onload:L.bind(this._onCanvasLoad,this)})},_reset:function(){var t=this._canvas,i=this._map.getSize();if(this._setCanvasPosition(),t.width=i.x,t.height=i.y,t.style.width=i.x+"px",t.style.height=i.y+"px",this._map._bearing)return;const{gradient:e}=this.options;this._hor_gradient||(this._hor_gradient=this._ctx.createLinearGradient(0,0,0,e.size),this._hor_gradient.addColorStop(0,"rgba(255, 255, 255, "+e.opacity+")"),this._hor_gradient.addColorStop(1,"rgba(255, 255, 255, 0)")),this._ctx.fillStyle=this._hor_gradient,this._ctx.fillRect(0,0,i.x,e.size),this._vert_gradient||(this._vert_gradient=this._ctx.createLinearGradient(0,0,e.size,0),this._vert_gradient.addColorStop(0,"rgba(255, 255, 255, "+e.opacity+")"),this._vert_gradient.addColorStop(1,"rgba(255, 255, 255, 0)")),this._ctx.fillStyle=this._vert_gradient,this._ctx.fillRect(0,0,e.size,i.y),this._ctx.beginPath(),this._ctx.moveTo(0,0),this._ctx.lineTo(i.x,0),this._ctx.lineTo(i.x,i.y),this._ctx.stroke(),this._calcInterval(),this._draw()},_onCanvasLoad:function(){this.fire("load")},_calcInterval:function(){const{zoomInterval:t}=this.options,i=this._map.getZoom();if(void 0!==t)for(const e in t){const n=t[e];if(n.start<=i&&n.end&&n.end>=i){this._interval=n.interval;break}}else this._interval=L.Control.Scale.prototype._getRoundNum(this._map.containerPointToLatLng([0,this._map.getSize().y/2]).distanceTo(this._map.containerPointToLatLng([L.Control.Scale.prototype.options.maxWidth,this._map.getSize().y/2])));this._currZoom=i},_draw:function(){this._ctx.strokeStyle=this.options.color,this._create_lat_ticks(),this._create_lon_ticks(),this._ctx.fillStyle=this.options.color,this._ctx.font=this.options.font;const t=this._map.getSize(),i=this._interval>=1e3?this._interval/1e3+" km":this._interval+" m";this._ctx.textAlign="left",this._ctx.textBaseline="middle",this._ctx.fillText(i,12,t.y/2),this._ctx.textAlign="center",this._ctx.textBaseline="top",this._ctx.fillText(i,t.x/2,12)},_create_lat_ticks:function(){const{weight:t}=this.options,i=this._map.getSize(),e=Math.PI/180,n=this._merLength(this._map.containerPointToLatLng(L.point(0,i.y/2)).lat*e),o=this._merLength(this._map.containerPointToLatLng(L.point(0,0)).lat*e),s=this._merLength(this._map.containerPointToLatLng(L.point(0,i.y)).lat*e);for(let i=n+this._interval/2;i<o;i+=this._interval){const e=this._invmerLength(i);e<this._LIMIT_PHI&&e>-this._LIMIT_PHI&&this._draw_lat_tick(e,10,1.5*t)}for(let i=n-this._interval/2;i>s;i-=this._interval){const e=this._invmerLength(i);e>-this._LIMIT_PHI&&e<this._LIMIT_PHI&&this._draw_lat_tick(e,10,1.5*t)}for(let i=n;i<o;i+=this._interval/10){const e=this._invmerLength(i);e<this._LIMIT_PHI&&e>-this._LIMIT_PHI&&this._draw_lat_tick(e,4,t)}for(let i=n-this._interval/10;i>s;i-=this._interval/10){const e=this._invmerLength(i);e>-this._LIMIT_PHI&&e<this._LIMIT_PHI&&this._draw_lat_tick(e,4,t)}},_create_lon_ticks:function(){const{weight:t}=this.options,i=this._map.getSize(),e=Math.PI/180,n=180/Math.PI,o=this._map.containerPointToLatLng(L.point(i.x/2,0)),s=this._map.containerPointToLatLng(L.point(0,0)),a=this._map.containerPointToLatLng(L.point(i.x,0)),r=Math.pow(Math.sin(o.lat*e),2),h=this._a/Math.sqrt(1-this._e2*r),l=this._interval/(h*Math.cos(o.lat*e))*n;for(let i=o.lng+l/2;i<a.lng;i+=l)this._draw_lon_tick(i,10,1.5*t);for(let i=o.lng-l/2;i>s.lng;i-=l)this._draw_lon_tick(i,10,1.5*t);for(let i=o.lng;i<a.lng;i+=l/10)this._draw_lon_tick(i,4,t);for(let i=o.lng-l/10;i>s.lng;i-=l/10)this._draw_lon_tick(i,4,t)},_setCanvasPosition:function(){let t=this._map.containerPointToLayerPoint([0,0]);this._map._bearing&&(t=this._map.rotatedPointToMapPanePoint(this._map.containerPointToLayerPoint(L.point(this._map._container.getBoundingClientRect())))),L.DomUtil.setPosition(this._canvas,t)},_latLngToCanvasPoint:function(t){return L.point(this._map.project(L.latLng(t))._subtract(this._map.getPixelOrigin())).add(this._map._getMapPanePos())},_draw_lat_tick:function(t,i,e){const n=180/Math.PI,o=(this._map.getSize(),this._latLngToCanvasPoint(L.latLng(t*n,0)).y);this._ctx.lineWidth=e,this._ctx.beginPath(),this._ctx.moveTo(0,o),this._ctx.lineTo(+i,o),this._ctx.stroke()},_draw_lon_tick:function(t,i,e){const n=this._latLngToCanvasPoint(L.latLng(0,t)).x;this._ctx.lineWidth=e,this._ctx.beginPath(),this._ctx.moveTo(n,0),this._ctx.lineTo(n,i),this._ctx.stroke()},_merLength:function(t){const i=Math.cos(2*t),e=Math.sin(2*t);return this._A*(t+e*(this._c1+(this._c2+(this._c3+(this._c4+this._c5*i)*i)*i)*i))},_invmerLength:function(t){const i=t/this._A,e=Math.cos(2*i);return i+Math.sin(2*i)*(this._ic1+(this._ic2+(this._ic3+(this._ic4+this._ic5*e)*e)*e)*e)}}),L.control.edgeScale=function(t){return new L.Control.EdgeScale(t)},L.Map.mergeOptions({edgeScaleControl:!1}),L.Map.addInitHook((function(){this.options.edgeScaleControl&&(this.edgeScaleControl=new L.Control.EdgeScale,this.addControl(this.edgeScaleControl))}))}}]);
//# sourceMappingURL=27.bundle.js.map