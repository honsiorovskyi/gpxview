"use strict";(self.webpackChunkgpx_viewer=self.webpackChunkgpx_viewer||[]).push([[530],{530:(t,e,i)=>{i.r(e),L.DistanceMarker=L.CircleMarker.extend({_updatePath:function(){let t=this._renderer._ctx,e=this._point;if(this.options.rotation=this.options.rotation||0,this.options.radius&&this._renderer._updateCircle&&this._renderer._updateCircle(this),this.options.icon&&this.options.icon.url)if(this.options.icon.element){const i=this.options.icon;let o=e.x+i.offset.x,s=e.y+i.offset.y;t.save(),i.rotate&&(t.translate(e.x,e.y),t.rotate(i.rotate),o=0,s=0),t.drawImage(i.element,o-i.size[0]/2,s-i.size[1]/2,i.size[0],i.size[1]),t.restore()}else{const t=document.createElement("img");this.options.icon=L.extend({rotate:0,size:[40,40],offset:{x:0,y:0}},this.options.icon),this.options.icon.rotate+=this.options.rotation,this.options.icon.element=t,t.src=this.options.icon.url,t.onload=()=>this.redraw(),t.onerror=()=>this.options.icon=null}if(this.options.label){let i=e.x,o=e.y;t.save(),t.font=this.options.font||'normal 7pt "Helvetica Neue", Arial, Helvetica, sans-serif',t.textAlign="center",t.textBaseline="middle",t.fillStyle=this.options.fillStyle||"black",this.options.rotation&&(t.translate(e.x,e.y),t.rotate(this.options.rotation),i=0,o=0),this._map.getZoom()>17&&(t.fillStyle=this.options.strokeStyle||"black"),t.fillText(this.options.label,i,o),this.options.strokeStyle&&this._map.getZoom()<=17&&(t.strokeStyle=this.options.strokeStyle,t.strokeText(this.options.label,i,o)),t.restore()}}}),L.DistanceMarkers=L.LayerGroup.extend({options:{cssClass:"dist-marker",iconSize:[12,12],arrowSize:[10,10],arrowUrl:"data:image/svg+xml,%3Csvg transform='rotate(90)' xmlns='http://www.w3.org/2000/svg' width='560px' height='560px' viewBox='0 0 560 560'%3E%3Cpath stroke-width='35' fill='%23000' stroke='%23FFF' d='M280,40L522,525L280,420L38,525z'/%3E%3C/svg%3E",offset:1e3,showAll:12,textFunction:(t,e,i)=>e,distance:!0,direction:!0},initialize:function(t,e,i){this._layers={},this._zoomLayers={},i=L.setOptions(this,i);let o=e.options.preferCanvas,s=Math.min(e.getMaxZoom(),i.showAll);o||e.options.rotate||console.warn('Missing dependency: "leaflet-rotate"');let r="function"==typeof t.getLatLngs?t.getLatLngs():t;r=L.LineUtil.isFlat(r)?[r]:r,r.forEach((t=>{let r=L.GeometryUtil.accumulatedLengths(t),n=r.length>0?r[r.length-1]:0;for(let a=1,l=Math.floor(n/i.offset),c=0;a<=l;++a){let n=i.offset*a;for(;c<r.length-1&&r[c]<n;)++c;let l=t[c-1],h=t[c],d=L.polyline([l,h]),p=(n-r[c-1])/(r[c]-r[c-1]),m=L.GeometryUtil.interpolateOnLine(e,d,p),f=e.project(h).subtract(e.project(l)),y=Math.atan2(f.y,f.x),_=i.textFunction.call(this,n,a,i.offset),k=this._minimumZoomLevelForItem(a,s),u=this._zoomLayers[k]=this._zoomLayers[k]||L.layerGroup();i.direction&&(i.distance&&a%2==1||!i.distance)&&(o?u.addLayer(new L.DistanceMarker(l,{radius:0,icon:{url:i.arrowUrl,size:i.arrowSize,rotate:0,offset:{x:0,y:0}},rotation:y,interactive:!1})):u.addLayer(L.marker(m.latLng,{icon:L.icon({iconUrl:i.arrowUrl,iconSize:i.arrowSize}),rotation:y,interactive:!1}))),i.distance&&a%2==0&&(o?u.addLayer(new L.DistanceMarker(m.latLng,{label:_,radius:7,fillColor:"#fff",fillOpacity:1,fillStyle:"black",color:"#777",weight:1,interactive:!1})):u.addLayer(L.marker(m.latLng,{title:_,icon:L.divIcon({className:i.cssClass,html:_,iconSize:i.iconSize}),interactive:!1})))}}));const n=()=>{let t=this._lastZoomLevel||0,i=e.getZoom();if(i>t)for(let e=t+1;e<=i;++e)void 0!==this._zoomLayers[e]&&this.addLayer(this._zoomLayers[e]);else if(i<t)for(let e=t;e>i;--e)void 0!==this._zoomLayers[e]&&this.removeLayer(this._zoomLayers[e]);this._lastZoomLevel=i};e.on("zoomend",n),n()},_minimumZoomLevelForItem:function(t,e){for(;t>0&&t%2==0;)--e,t=Math.floor(t/2);return e}}),L.Polyline.include({_originalOnAdd:L.Polyline.prototype.onAdd,_originalOnRemove:L.Polyline.prototype.onRemove,addDistanceMarkers:function(){this._map&&this._distanceMarkers&&this._map.addLayer(this._distanceMarkers)},removeDistanceMarkers:function(){this._map&&this._distanceMarkers&&this._map.removeLayer(this._distanceMarkers)},onAdd:function(t){this._originalOnAdd(t);let e=this.options.distanceMarkers||{};this.options.distanceMarkers&&(this._distanceMarkers=this._distanceMarkers||new L.DistanceMarkers(this,t,e)),void 0!==e.lazy&&!1!==e.lazy||this.addDistanceMarkers()},onRemove:function(t){this.removeDistanceMarkers(),this._originalOnRemove(t)}})}}]);
//# sourceMappingURL=530.bundle.js.map