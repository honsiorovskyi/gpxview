{"version":3,"file":"284.bundle.js","mappings":"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","sources":["webpack://gpx-viewer/./node_modules/@raruto/leaflet-elevation/src/handlers/runner.js"],"sourcesContent":["/**\n * @see https://github.com/Igor-Vladyka/leaflet.motion\n * \n * @example\n * ```js\n * L.control.Elevation({ handlers: [ 'Runner' ], runnerOptions: { polyline: {..}, motion: {..}, marker {..} } })\n * ```\n */\nexport async function Runner() {\n\n  await this.import(this.__LMOTION || 'https://unpkg.com/leaflet.motion@0.3.2/dist/leaflet.motion.min.js', typeof L.Motion !== 'object')\n\n  let { runnerOptions } = this.options;\n\n  runnerOptions = L.extend(\n    { polyline: {}, motion: {}, marker: undefined },\n    'object' === typeof runnerOptions ? runnerOptions : {}\n  );\n\n  // Custom tooltips\n  this._registerTooltip({\n    name: 'here',\n    marker: (item) => L._(\"You are here: \"),\n    order: 1,\n  });\n\n  this._registerTooltip({\n    name: 'distance',\n    marker: (item) => Math.round(item.dist) + \" \" + this.options.xLabel,\n    order: 2,\n  });\n\n  this.addCheckpoint = function (checkpoint) {\n    return this._registerCheckPoint({ // <-- NB these are private functions use them at your own risk!\n      latlng: this._findItemForX(this._x(checkpoint.dist)).latlng,\n      label: checkpoint.label || ''\n    });\n  }\n\n  this.addRunner = function (runner) {\n    let x = this._x(runner.dist);\n    let y = this._y(this._findItemForX(x).z)\n    let g = d3.select(this._container)\n      .select('svg > g')\n      .append(\"svg:circle\")\n      .attr(\"class\", \"runner \" + this.options.theme + \" height-focus circle-lower\")\n      .attr(\"r\", 6)\n      .attr(\"cx\", x)\n      .attr(\"cy\", y);\n    return g;\n  }\n\n  this.setPositionFromLatLng = function (latlng) {\n    this._onMouseMoveLayer({ latlng: latlng }); // Update map and chart \"markers\" from latlng\n  };\n\n  this.tick = function (runner, dist = 0, inc = 0.1) {\n    dist = (dist <= this.track_info.distance - inc) ? dist + inc : 0;\n    this.updateRunnerPos(runner, dist);\n    setTimeout(() => this.tick(runner, dist), 150);\n  };\n\n  this.updateRunnerPos = function (runner, pos) {\n    let curr, x;\n\n    if (pos instanceof L.LatLng) {\n      curr = this._findItemForLatLng(pos);\n      x = this._x(curr.dist);\n    } else {\n      x    = this._x(pos);\n      curr = this._findItemForX(x);\n    }\n\n    runner\n      .attr(\"cx\", x)\n      .attr(\"cy\", this._y(curr.z));\n    this.setPositionFromLatLng(curr.latlng);\n  };\n\n  this.animate = function (layer, speed = 1500) {\n\n    if (this._runner) {\n      this._runner.remove();\n    }\n\n    layer.setStyle({ opacity: 0.5 });\n\n    const geo = L.geoJson(layer.toGeoJSON(), { coordsToLatLng: (coords) => L.latLng(coords[0], coords[1], coords[2] * (this.options.altitudeFactor || 1)) });\n    this._runner = L.motion.polyline(\n      geo.toGeoJSON().features[0].geometry.coordinates, \n      L.extend({}, { color: 'red', pane: 'elevationPane', attribution: '' }, runnerOptions.polyline), \n      L.extend({}, { auto: true, speed: speed, }, runnerOptions.motion),\n      runnerOptions.marker || undefined\n    );\n\n    // Override default function behavior: `L.Motion.Polyline::_drawMarker()` \n    this._runner._drawMarker = new Proxy(this._runner._drawMarker, {\n      apply: (target, thisArg, argArray) => {\n        thisArg._runner = thisArg._runner || this.addRunner({ dist: 0 });\n        this.updateRunnerPos(thisArg._runner, argArray[0]);\n        return target.apply(thisArg, argArray);\n      }\n    });\n\n    this._runner.addTo(this._map);\n  };\n\n  return {};\n}\n"],"names":["async","Runner","this","import","__LMOTION","L","Motion","runnerOptions","options","extend","polyline","motion","marker","undefined","_registerTooltip","name","item","_","order","Math","round","dist","xLabel","addCheckpoint","checkpoint","_registerCheckPoint","latlng","_findItemForX","_x","label","addRunner","runner","x","y","_y","z","d3","select","_container","append","attr","theme","setPositionFromLatLng","_onMouseMoveLayer","tick","inc","track_info","distance","updateRunnerPos","setTimeout","pos","curr","LatLng","_findItemForLatLng","animate","layer","speed","_runner","remove","setStyle","opacity","geo","geoJson","toGeoJSON","coordsToLatLng","coords","latLng","altitudeFactor","features","geometry","coordinates","color","pane","attribution","auto","_drawMarker","Proxy","apply","target","thisArg","argArray","addTo","_map"],"sourceRoot":""}